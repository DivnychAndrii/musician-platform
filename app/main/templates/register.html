{% extends "base.html" %}
{% block content %}

{% if not request.user.is_authenticated %}
<main role="main">
  <section class="jumbotron text-center">
    <div class="container">
      <h1 class="jumbotron-heading">Register here</h1>
    </div>
  </section>
</main>
<div class="modal-body">
      <form class='login-form'>
        <style>
        .login-form {
          max-width:500px;
          margin:auto;
        }
        </style>
              <div class="form-group">
                <label for="exampleInputName">Name</label>
                <input type="text" class="form-control" id="exampleInputName" aria-describedby="emailHelp" placeholder="Name">
              </div>

              <div class="form-group">
                <label for="exampleInputEmail">Email address</label>
                <input type="email" class="form-control" id="exampleInputEmail" aria-describedby="emailHelp" placeholder="Enter email">
              </div>

              <div class="form-group">
                <label for="exampleInputPassword">Create Password</label>
                <input type="password" class="form-control" id="exampleInputPassword" placeholder="Password" />
              </div>
              <button type="button"  class="btn btn-dark btn-lg btn-block login-btn mb-2 mt-2" id="but" >Sign up</button>

            </form>
</div>
{% else %}
<div class="modal-body">
      <form class='login-form'>
        <style>
        .login-form {
          max-width:500px;
          margin:auto;
        }
        </style>
        <h2>Hi! {{ request.user.first_name }} {{ request.user.last_name }}</h2>
        <br>
        <p>Your Email address is : {{ request.user.email }}</p>
        <br>
        <a class="btn btn-dark"href="/logout">Logout</a>
        </form>
</div>
{% endif %}

    <script >
    $(document).ready(function(){
      console.log(1);
      $("#but").click(function(){
        signup();
      });
          function signup(){
              email = document.getElementById("exampleInputEmail").value;
              name = document.getElementById("exampleInputName").value;
              password = document.getElementById("exampleInputPassword").value;
              $("#erroremail").html("");
              $("#errorpass").html("");
              $.ajax({
                type:"POST",
                url:'/api/auth/',
                data:{
                    'name':name,
                    'email':email,
                    'password':password,
                },
                success: function (data) {
                  console.log(data);
                  window.location.href = 'http://127.0.0.1:8000/login/';
                  },
            });
          }
        });
    </script>

{% endblock content %}
